<Window x:Class="WpfRaziLedgerApp.DeskWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" FontFamily="{StaticResource NewFont}"
        WindowStyle="None" AllowsTransparency="True" Background="#AD000000"
        ShowInTaskbar="False" Topmost="True"
        WindowStartupLocation="CenterScreen"
        KeyDown="Window_KeyDown"
        MouseDown="Window_MouseDown"
        Width="{Binding Source={x:Static SystemParameters.PrimaryScreenWidth}}"
        Height="{Binding Source={x:Static SystemParameters.PrimaryScreenHeight}}">

    <Window.Resources>
        <!-- باز شدن میز (Scale + Opacity) -->
        <Storyboard x:Key="OpenDeskStoryboard">
            <DoubleAnimation Storyboard.TargetName="DeskContainer"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                             From="0" To="1" Duration="0:0:0.35" />
            <DoubleAnimation Storyboard.TargetName="DeskContainer"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                             From="0" To="1" Duration="0:0:0.35" />
            <DoubleAnimation Storyboard.TargetName="DeskContainer"
                             Storyboard.TargetProperty="Opacity"
                             From="0" To="1" Duration="0:0:0.25"/>
            <DoubleAnimation Storyboard.TargetName="gridtop"
                             Storyboard.TargetProperty="Opacity"
                             From="0" To="1" Duration="0:0:0.35"/>
            <DoubleAnimation Storyboard.TargetName="stackimages"
                             Storyboard.TargetProperty="Opacity"
                             From="0" To="1" Duration="0:0:0.35"/>
        </Storyboard>

        <!-- بسته شدن میز -->
        <Storyboard x:Key="CloseDeskStoryboard">
            <DoubleAnimation Storyboard.TargetName="DeskContainer"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                             From="1" To="0" Duration="0:0:0.35" />
            <DoubleAnimation Storyboard.TargetName="DeskContainer"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                             From="1" To="0" Duration="0:0:0.35" />
            <DoubleAnimation Storyboard.TargetName="DeskContainer"
                             Storyboard.TargetProperty="Opacity"
                             From="1" To="0" Duration="0:0:0.25"/>
            <DoubleAnimation Storyboard.TargetName="gridtop"
                             Storyboard.TargetProperty="Opacity"
                             From="1" To="0" Duration="0:0:0.25"/>
            <DoubleAnimation Storyboard.TargetName="stackimages"
                             Storyboard.TargetProperty="Opacity"
                             From="1" To="0" Duration="0:0:0.25"/>
        </Storyboard>

        <Style TargetType="Image" x:Key="InteractiveImage">
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <TransformGroup>
                        <ScaleTransform/>
                        <RotateTransform/>
                    </TransformGroup>
                </Setter.Value>
            </Setter>

            <Style.Triggers>
                <!-- بزرگ شدن وقتی ماوس روی عکس میره -->
                <EventTrigger RoutedEvent="MouseEnter">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.(TransformGroup.Children)[0].ScaleX"
                                         To="1.2" Duration="0:0:0.2"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.(TransformGroup.Children)[0].ScaleY"
                                         To="1.2" Duration="0:0:0.2"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>

                <!-- برگشتن به حالت عادی وقتی ماوس بیرون میره -->
                <EventTrigger RoutedEvent="MouseLeave">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.(TransformGroup.Children)[0].ScaleX"
                                         To="1" Duration="0:0:0.2"/>
                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.(TransformGroup.Children)[0].ScaleY"
                                         To="1" Duration="0:0:0.2"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>

                <!-- لرزش (چرخش سریع) هنگام کلیک -->
                <EventTrigger RoutedEvent="MouseLeftButtonDown">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames 
                            Storyboard.TargetProperty="RenderTransform.(TransformGroup.Children)[1].Angle"
                            Duration="0:0:0.4" RepeatBehavior="1x">
                                <LinearDoubleKeyFrame Value="0" KeyTime="0:0:0"/>
                                <LinearDoubleKeyFrame Value="-15" KeyTime="0:0:0.1"/>
                                <LinearDoubleKeyFrame Value="15" KeyTime="0:0:0.2"/>
                                <LinearDoubleKeyFrame Value="-5" KeyTime="0:0:0.3"/>
                                <LinearDoubleKeyFrame Value="0" KeyTime="0:0:0.4"/>
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid VerticalAlignment="Center">
        <Grid.RowDefinitions>
            <RowDefinition Height="70"/>
            <RowDefinition Height="270"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid Width="1000" FlowDirection="RightToLeft" Name="gridtop" Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Border Width="141" Height="142" IsHitTestVisible="False" Name="rect2" Grid.Column="0" Opacity="1" Visibility="Hidden" Panel.ZIndex="10" CornerRadius="5" Margin="0 0 0 11" VerticalAlignment="Center">
                <Border.Background>
                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                        <GradientStop Color="#A59CEBFF"/>
                        <GradientStop Color="#A5C1D8FF" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
            </Border>
            <Border Width="141" Height="142" IsHitTestVisible="False" Name="rect" BorderBrush="#FF008EB3" BorderThickness="1" Grid.Column="0" Opacity="1" Visibility="Hidden" Panel.ZIndex="10" CornerRadius="5" Margin="0 0 0 11" VerticalAlignment="Center">
                <Border.Background>
                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                        <GradientStop Color="#7FD4E4FF"/>
                        <GradientStop Color="#7F647BA2" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
            </Border>
            <StackPanel Background="Transparent" VerticalAlignment="Center" Cursor="Hand" MouseEnter="StackPanel_MouseEnter" MouseLeave="StackPanel_MouseLeave"  MouseDown="StackPanel_MouseDown">
                <Image Source="/Images/MizImages/book.png" Width="95" Height="95"/>
                <TextBlock Text="تعاریف" Margin="0 10" FontSize="21" FontWeight="Bold" HorizontalAlignment="Center">
                    <TextBlock.Foreground>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="AliceBlue"/>
                            <GradientStop Color="#FFC8E4FF" Offset="0.51"/>
                            <GradientStop Color="#FF6590BB" Offset="1"/>
                        </LinearGradientBrush>
                    </TextBlock.Foreground>
                </TextBlock>
            </StackPanel>
            <StackPanel Background="Transparent" VerticalAlignment="Center" Cursor="Hand" Grid.Column="1" MouseEnter="StackPanel_MouseEnter" MouseLeave="StackPanel_MouseLeave"  MouseDown="StackPanel_MouseDown">
                <Image Source="/Images/MizImages/shoppingcart.png" Width="95" Height="95"/>
                <TextBlock Text="خرید و فروش" Margin="0 10" FontSize="21" FontWeight="Bold"  HorizontalAlignment="Center">
                    <TextBlock.Foreground>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="AliceBlue"/>
                            <GradientStop Color="#FFC8E4FF" Offset="0.51"/>
                            <GradientStop Color="#FF6590BB" Offset="1"/>
                        </LinearGradientBrush>
                    </TextBlock.Foreground>
                </TextBlock>
            </StackPanel>
            <StackPanel Background="Transparent" VerticalAlignment="Center" Cursor="Hand" Grid.Column="2"  MouseEnter="StackPanel_MouseEnter" MouseLeave="StackPanel_MouseLeave"  MouseDown="StackPanel_MouseDown">
                <Image Source="/Images/MizImages/creditcard.png" Width="95" Height="95"/>
                <TextBlock Text="مالی" Margin="0 10" FontSize="21" FontWeight="Bold"  HorizontalAlignment="Center">
                    <TextBlock.Foreground>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="AliceBlue"/>
                            <GradientStop Color="#FFC8E4FF" Offset="0.51"/>
                            <GradientStop Color="#FF6590BB" Offset="1"/>
                        </LinearGradientBrush>
                    </TextBlock.Foreground>
                </TextBlock>
            </StackPanel>
            <StackPanel Background="Transparent" VerticalAlignment="Center" Cursor="Hand" Grid.Column="3" MouseEnter="StackPanel_MouseEnter" MouseLeave="StackPanel_MouseLeave"  MouseDown="StackPanel_MouseDown">
                <Image Source="/Images/MizImages/shield.png" Width="95" Height="95" />
                <TextBlock Text="خزانه داری" Margin="0 10" FontSize="21" FontWeight="Bold"  HorizontalAlignment="Center">
                    <TextBlock.Foreground>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="AliceBlue"/>
                            <GradientStop Color="#FFC8E4FF" Offset="0.51"/>
                            <GradientStop Color="#FF6590BB" Offset="1"/>
                        </LinearGradientBrush>
                    </TextBlock.Foreground>
                </TextBlock>
            </StackPanel>
            <StackPanel Background="Transparent" VerticalAlignment="Center" Cursor="Hand" Grid.Column="4" MouseEnter="StackPanel_MouseEnter" MouseLeave="StackPanel_MouseLeave"  MouseDown="StackPanel_MouseDown">
                <Image Source="/Images/MizImages/package.png" Width="95" Height="95" />
                <TextBlock Text="انبار" Margin="0 10" FontSize="21" FontWeight="Bold"  HorizontalAlignment="Center">
                    <TextBlock.Foreground>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="AliceBlue"/>
                            <GradientStop Color="#FFC8E4FF" Offset="0.51"/>
                            <GradientStop Color="#FF6590BB" Offset="1"/>
                        </LinearGradientBrush>
                    </TextBlock.Foreground>
                </TextBlock>
            </StackPanel>
            <StackPanel Background="Transparent" VerticalAlignment="Center" Cursor="Hand" Grid.Column="5" MouseEnter="StackPanel_MouseEnter" MouseLeave="StackPanel_MouseLeave"  MouseDown="StackPanel_MouseDown">
                <Image Source="/Images/MizImages/filetext.png" Width="95" Height="95" />
                <TextBlock Text="گزارشات" Margin="0 10" FontSize="21" FontWeight="Bold"  HorizontalAlignment="Center">
                    <TextBlock.Foreground>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="AliceBlue"/>
                            <GradientStop Color="#FFC8E4FF" Offset="0.51"/>
                            <GradientStop Color="#FF6590BB" Offset="1"/>
                        </LinearGradientBrush>
                    </TextBlock.Foreground>
                </TextBlock>
            </StackPanel>
            <StackPanel Background="Transparent" VerticalAlignment="Center" Cursor="Hand" Grid.Column="6" MouseEnter="StackPanel_MouseEnter" MouseLeave="StackPanel_MouseLeave"  MouseDown="StackPanel_MouseDown">
                <Image Source="/Images/MizImages/tool.png" Width="95" Height="95" />
                <TextBlock Text="امکانات" Margin="0 10" FontSize="21" FontWeight="Bold"  HorizontalAlignment="Center">
                    <TextBlock.Foreground>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="AliceBlue"/>
                            <GradientStop Color="#FFC8E4FF" Offset="0.51"/>
                            <GradientStop Color="#FF6590BB" Offset="1"/>
                        </LinearGradientBrush>
                    </TextBlock.Foreground>
                </TextBlock>
            </StackPanel>
        </Grid>
        <StackPanel x:Name="stackimages" HorizontalAlignment="Right" Grid.Row="2" VerticalAlignment="Center" Margin="0 0 20 350">
            <Image Cursor="Hand" Visibility="Collapsed" MouseLeftButtonDown="imageMiz_MouseLeftButtonDown" Name="imageMiz" Style="{StaticResource InteractiveImage}" Source="/Images/MizImages/unnamed.png" Width="153" Height="128" ToolTip="میز کار"/>
            <Image Cursor="Hand" Name="imageMizSetting" Style="{StaticResource InteractiveImage}" Source="/Images/Tools/DoshboardSetting2.png" Width="128" Height="128" Margin="0 30" ToolTip="تنظیمات میز کار" MouseLeftButtonDown="imageMizSetting_MouseLeftButtonDown"/>
        </StackPanel>
        <!-- ظرف اصلی میز -->
        <Grid x:Name="DeskContainer" Opacity="0" Grid.Row="2" Margin="0 0 0 300"
              RenderTransformOrigin="0.5,0.5">
            <Grid.RenderTransform>
                <ScaleTransform ScaleX="0" ScaleY="0"/>
            </Grid.RenderTransform>

            <Border x:Name="DeskBorder" BorderThickness="1" CornerRadius="20" BorderBrush="#FF242440"
                    Width="576" Height="383"
                    HorizontalAlignment="Center" VerticalAlignment="Center">
                <Grid>
                    <!-- تصویر میز -->
                    <Image x:Name="DeskImage"
                           Source="pack://application:,,,/Images/Miz.png"
                           Stretch="Uniform"
                           Panel.ZIndex="0">
                        <Image.Clip>
                        <RectangleGeometry Rect="0,0,574,380" RadiusX="20" RadiusY="20"/>
                        </Image.Clip>
                    </Image>

                    <!-- شبکه آیکون‌ها -->
                    <Grid x:Name="DeskGrid" Margin="10" Panel.ZIndex="1" FlowDirection="RightToLeft">
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                    </Grid>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
